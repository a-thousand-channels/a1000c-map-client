(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{381:function(e,t,r){var n;"undefined"!=typeof self&&self,n=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(object,e){return Object.prototype.hasOwnProperty.call(object,e)},r.p="",r(r.s=8)}([function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r(2);let o={js:(e,t)=>e===t?0:e<t?-1:1,"abstract-js":(e,t)=>e==t?0:e<t?-1:1,"abstract-date":(e,t)=>{let r=new Date(e).toISOString(),n=new Date(t).toISOString();return r==n?0:r<n?-1:1},loki:(e,t)=>Object(n.b)(e,t)?0:Object(n.c)(e,t,!1)?-1:1}},function(e,t,r){"use strict";(function(e){function n(){let t;return function(e){t=e}(void 0!==e&&e||this),t}r.d(t,"a",(function(){return o}));const o=function(){const e=n(),t=Symbol.for("LOKI");return void 0===e[t]&&(e[t]={}),e[t]}()}).call(this,r(7))},function(e,t,r){"use strict";function n(e,t){if(e===t)return!0;if(!e||!t||!0===e||!0===t||e!=e||t!=t){let r,n;switch(e){case void 0:case null:r=1;break;case!1:r=3;break;case!0:r=4;break;case"":r=5;break;default:r=e==e?9:0}switch(t){case void 0:case null:n=1;break;case!1:n=3;break;case!0:n=4;break;case"":n=5;break;default:n=t==t?9:0}if(9!==r||9!==n)return r===n}let r=Number(e),n=Number(t);return r==r||n==n?r===n:(r=e.toString(),n=t.toString(),r==n)}function o(e,t,r){if(!e||!t||!0===e||!0===t||e!=e||t!=t){let n,o;switch(e){case void 0:case null:n=1;break;case!1:n=3;break;case!0:n=4;break;case"":n=5;break;default:n=e==e?9:0}switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}if(9!==n||9!==o)return n===o?r:n<o}let n=Number(e),o=Number(t);return n==n&&o==o?n<o||!(n>o)&&r:n==n&&o!=o||(o!=o||n==n)&&(e<t||!(e>t)&&(e==t?r:(n=e.toString(),o=t.toString(),n<o||n==o&&r)))}function l(e,t,r){if(!e||!t||!0===e||!0===t||e!=e||t!=t){let n,o;switch(e){case void 0:case null:n=1;break;case!1:n=3;break;case!0:n=4;break;case"":n=5;break;default:n=e==e?9:0}switch(t){case void 0:case null:o=1;break;case!1:o=3;break;case!0:o=4;break;case"":o=5;break;default:o=t==t?9:0}if(9!==n||9!==o)return n===o?r:n>o}let n=Number(e),o=Number(t);return n==n&&o==o?n>o||!(n<o)&&r:(n!=n||o==o)&&(o==o&&n!=n||e>t||!(e<t)&&(e==t?r:(n=e.toString(),o=t.toString(),n>o||n==o&&r)))}function h(e,t,r){return n(e,t)?0:o(e,t,!1)?r?1:-1:l(e,t,!1)?r?-1:1:0}r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return h})),r.d(t,"a",(function(){return c}));class d{$eq(a,b){return a===b}$ne(a,b){return a!==b}$gt(a,b){return a>b}$gte(a,b){return a>=b}$lt(a,b){return a<b}$lte(a,b){return a<=b}$between(a,e){return null!=a&&a>=e[0]&&a<=e[1]}$in(a,b){return-1!==b.indexOf(a)}$nin(a,b){return-1===b.indexOf(a)}$keyin(a,b){return a in b}$nkeyin(a,b){return!(a in b)}$definedin(a,b){return void 0!==b[a]}$undefinedin(a,b){return void 0===b[a]}$regex(a,b){return b.test(a)}$containsNone(a,b){return!this.$containsAny(a,b)}$containsAny(a,b){const e=this.containsCheckFn(a);return null!==e&&(Array.isArray(b)?b.some(e):e(b))}$contains(a,b){const e=this.containsCheckFn(a);return null!==e&&(Array.isArray(b)?b.every(e):e(b))}$type(a,b){let e=typeof a;return"object"===e&&(Array.isArray(a)?e="array":a instanceof Date&&(e="date")),"object"!=typeof b?e===b:this.doQueryOp(e,b)}$finite(a,b){return b===isFinite(a)}$size(a,b){return!!Array.isArray(a)&&("object"!=typeof b?a.length===b:this.doQueryOp(a.length,b))}$len(a,b){return"string"==typeof a&&("object"!=typeof b?a.length===b:this.doQueryOp(a.length,b))}$where(a,b){return!0===b(a)}$not(a,b){return!this.doQueryOp(a,b)}$and(a,b){for(let e=0,t=b.length;e<t;e++)if(!this.doQueryOp(a,b[e]))return!1;return!0}$or(a,b){for(let e=0,t=b.length;e<t;e++)if(this.doQueryOp(a,b[e]))return!0;return!1}doQueryOp(e,t){for(let p in t)if(Object.hasOwnProperty.call(t,p))return this[p](e,t[p]);return!1}containsCheckFn(a){return"string"==typeof a||Array.isArray(a)?b=>-1!==a.indexOf(b):"object"==typeof a&&null!==a?b=>Object.hasOwnProperty.call(a,b):null}}let c={js:new d,loki:new class extends d{constructor(){super()}$eq(a,b){return n(a,b)}$ne(a,b){return!n(a,b)}$gt(a,b){return l(a,b,!1)}$gte(a,b){return l(a,b,!0)}$lt(a,b){return o(a,b,!1)}$lte(a,b){return o(a,b,!0)}$between(a,e){return null!=a&&l(a,e[0],!0)&&o(a,e[1],!0)}}}},function(e,t,r){"use strict";var n=r(5);class o{constructor(e){this._field=e,this._lokiMap={},this._valMap={}}set(e,t){if(null!=t){if(t in this._lokiMap)throw new Error("Duplicate key for property "+this._field+": "+t);if(e in this._valMap)throw new Error("Duplicate key for property $loki : "+e);this._lokiMap[t]=e,this._valMap[e]=t}}get(e){return this._lokiMap[e]}update(e,t){if(t!==this._valMap[e]){if(t in this._lokiMap)throw new Error("Duplicate key for property "+this._field+": "+t);this.remove(e),this.set(e,t)}}remove(e){if(!(e in this._valMap))throw new Error("Key is not in unique index: "+this._field);let t=this._valMap[e];delete this._lokiMap[t],delete this._valMap[e]}clear(){this._lokiMap={},this._valMap={}}}function l(e,t,r){return e instanceof Array?(e.push(r),e[e.length-1]):e instanceof Object?(e[t]=r,e[t]):void 0}function h(e,t){for(let r in e){let n=e[r];n instanceof Date?l(t,r,new Date(n.getTime())):n instanceof Function?l(t,r,n):n instanceof Array?h(n,l(t,r,[])):n instanceof Object?h(n,l(t,r,{})):l(t,r,n)}}function d(e){if(/number|string|boolean/.test(typeof e))return e;if(e instanceof Date)return new Date(e.getTime());const t=e instanceof Array?[]:{};return h(e,t),t}function c(data,e="parse-stringify"){if(null==data)return null;let t;switch(e){case"parse-stringify":t=JSON.parse(JSON.stringify(data));break;case"deep":t=d(data);break;case"shallow":t=Object.create(data.constructor.prototype),Object.assign(t,data);break;case"shallow-recurse":t=c(data,"shallow");const e=Object.keys(data);for(let i=0;i<e.length;i++){const r=e[i];"object"==typeof data[r]&&"Object"===data[r].constructor.name&&(t[r]=c(data[r],"shallow-recurse"))}}return t}var _=r(2),f=r(0);function m(e,t,r=0){if(++r>=10)return e;for(const n in e)if("string"==typeof e[n]&&0===e[n].indexOf("[%lktxp]")){const r=e[n].substring(8);void 0!==t[r]&&(e[n]=t[r])}else"object"==typeof e[n]&&(e[n]=m(e[n],t,r));return e}const v={$eq:!0,$dteq:!0,$gt:!0,$gte:!0,$lt:!0,$lte:!0,$in:!0,$between:!0};class w{constructor(e){this._filteredRows=[],this._filterInitialized=!1,this._scoring=null,this._collection=e}reset(){return this._filteredRows.length>0&&(this._filteredRows=[]),this._filterInitialized=!1,this}toJSON(){const e=this.copy();return e._collection=null,e}limit(e){return this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex()),this._filteredRows=this._filteredRows.slice(0,e),this._filterInitialized=!0,this}offset(e){return this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex()),this._filteredRows=this._filteredRows.slice(e),this._filterInitialized=!0,this}copy(){const e=new w(this._collection);return e._filteredRows=this._filteredRows.slice(),e._filterInitialized=this._filterInitialized,e}transform(e,t){"string"==typeof e&&(e=this._collection._transforms[e]),void 0!==t&&(e=function(e,t){if(void 0===t)return e;const r=[];for(let n=0;n<e.length;n++){const o=c(e[n],"shallow-recurse");r.push(m(o,t))}return r}(e,t));let r=this;for(let t=0;t<e.length;t++){const n=e[t];switch(n.type){case"find":r.find(n.value);break;case"where":r.where(n.value);break;case"simplesort":r.simplesort(n.property,n.options);break;case"compoundsort":r.compoundsort(n.value);break;case"sort":r.sort(n.value);break;case"sortByScoring":r.sortByScoring(n.desc);break;case"limit":r=r.limit(n.value);break;case"offset":r=r.offset(n.value);break;case"map":r=r.map(n.value,n.dataOptions);break;case"eqJoin":r=r.eqJoin(n.joinData,n.leftJoinKey,n.rightJoinKey,n.mapFun,n.dataOptions);break;case"mapReduce":r=r.mapReduce(n.mapFunction,n.reduceFunction);break;case"update":r.update(n.value);break;case"remove":r.remove()}}return r}sort(e){this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const data=this._collection._data;return this._filteredRows.sort(((a,b)=>e(data[a],data[b]))),this}simplesort(e,t={desc:!1}){if("boolean"==typeof t&&(t={desc:t}),!this._filterInitialized&&this._collection._rangedIndexes.hasOwnProperty(e)){let r=this._collection._rangedIndexes[e].index.rangeRequest(),n=[];for(let e of r)n.push(this._collection.get(e,!0)[1]);return this._filteredRows=t.desc?n.reverse():n,this._filterInitialized=!0,this}this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const data=this._collection._data;let r=t.sortComparator?f.a[t.sortComparator]:f.a[this._collection._unindexedSortComparator];return this._filteredRows.sort(((a,b)=>r(data[a][e],data[b][e]))),t.desc&&this._filteredRows.reverse(),this}compoundsort(e){if(0===e.length)throw new Error("Invalid call to compoundsort, need at least one property");if(1===e.length){const t=e[0];return"string"==typeof t?this.simplesort(t,!1):this.simplesort(t[0],t[1])}for(let i=0,t=e.length;i<t;i++){const t=e[i];"string"==typeof t&&(e[i]=[t,!1])}this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const data=this._collection._data;return this._filteredRows.sort(((a,b)=>this._compoundeval(e,data[a],data[b]))),this}_compoundeval(e,t,r){for(let i=0,n=e.length;i<n;i++){const n=e[i],o=n[0],l=Object(_.d)(t[o],r[o],n[1]);if(0!==l)return l}return 0}sortByScoring(e=!1){if(null===this._scoring)throw new Error("No scoring available");return e?this._filteredRows.sort(((a,b)=>this._scoring[a].score-this._scoring[b].score)):this._filteredRows.sort(((a,b)=>this._scoring[b].score-this._scoring[a].score)),this}getScoring(){if(null===this._scoring)throw new Error("No scoring available");const e=[];for(let i=0;i<this._filteredRows.length;i++)e.push(this._scoring[this._filteredRows[i]]);return e}findOr(e){const t=[],r=[],n=this.count();for(let o=0,l=e.length;o<l;o++){const l=this.copy().find(e[o])._filteredRows,h=l.length;if(h===n)return this;for(let e=0;e<h;e++){const n=l[e];void 0===r[n]&&(r[n]=!0,t.push(n))}}return this._filteredRows=t,this._filterInitialized=!0,this}$or(e){return this.findOr(e)}findAnd(e){for(let i=0,t=e.length;i<t;i++){if(0===this.count())return this;this.find(e[i])}return this}$and(e){return this.findAnd(e)}find(e,t=!1){if(0===this._collection._data.length)return this._filteredRows=[],this._filterInitialized=!0,this;const r=e||"getAll";let n,o,l;if("object"==typeof r){let e=[];for(let p in r){let t={};t[p]=r[p],e.push(t),void 0!==r[p]&&(n=p,o=r[p])}if(e.length>1)return this.find({$and:e},t)}if(!n||"getAll"===r)return t&&(this._filteredRows=this._collection._data.length>0?[0]:[],this._filterInitialized=!0),this;if("$and"===n||"$or"===n)return this[n](o),t&&this._filteredRows.length>1&&(this._filteredRows=this._filteredRows.slice(0,1)),this;let h="";if(null===o||"object"!=typeof o||o instanceof Date)h="$eq",l=o;else{if("object"!=typeof o)throw new Error("Do not know what you want to do.");for(let e in o)if(void 0!==o[e]){h=e,l=o[e];break}}"$regex"===h&&(Array.isArray(l)?l=new RegExp(l[0],l[1]):l instanceof RegExp||(l=new RegExp(l)));let d=!1;!this._filterInitialized&&this._collection._rangedIndexes[n]&&v[h]&&(d=!0);const c=_.a[this._collection._defaultLokiOperatorPackage],data=this._collection._data;let f=[];if(this._filterInitialized){let filter=this._filteredRows;if("$fts"===n){this._scoring=this._collection._fullTextSearch.search(r.$fts);let e=Object.keys(this._scoring);for(let i=0;i<e.length;i++)-1!==filter.indexOf(+e[i])&&f.push(+e[i])}else if(void 0!==this._collection._constraints.unique[n]&&"$eq"===h){const e=this._collection._constraints.unique[n].get(l);if(void 0!==e){const t=this._collection.get(e,!0)[1];-1!==filter.indexOf(t)&&f.push(t)}}else for(let i=0;i<filter.length;i++){let e=filter[i];c[h](data[e][n],l)&&f.push(e)}return this._filteredRows=f,this._filterInitialized=!0,this}if(this._filteredRows=f,this._filterInitialized=!0,"$fts"===n){this._scoring=this._collection._fullTextSearch.search(r.$fts);let e=Object.keys(this._scoring);for(let i=0;i<e.length;i++)f.push(+e[i]);return this}if(void 0!==this._collection._constraints.unique[n]&&"$eq"===h){const e=this._collection._constraints.unique[n].get(l);return void 0!==e&&f.push(this._collection.get(e,!0)[1]),this}if(!d){for(let i=0;i<data.length;i++)if(c[h](data[i][n],l)&&(f.push(i),t))return this;return this}if(this._collection._rangedIndexes[n]){if("$in"===h){let e=this._collection._rangedIndexes[n];for(let t of l){let r=e.index.rangeRequest({op:"$eq",val:t});for(let e of r)f.push(this._collection.get(e,!0)[1])}return this}if("$between"===h){let e=this._collection._rangedIndexes[n].index.rangeRequest({op:h,val:l[0],high:l[1]});for(let t of e)f.push(this._collection.get(t,!0)[1]);return this}let e=this._collection._rangedIndexes[n].index.rangeRequest({op:h,val:l});if(!0!==v[h])for(let t of e){let e=this._collection.get(t,!0)[1];v[h](data[e][n],l)&&f.push(e)}else for(let t of e)f.push(this._collection.get(t,!0)[1])}return this}where(e){let t,r=[];if("function"!=typeof e)throw new TypeError("Argument is not a stored view or a function");if(t=e,this._filterInitialized){let e=this._filteredRows.length;for(;e--;)!0===t(this._collection._data[this._filteredRows[e]])&&r.push(this._filteredRows[e]);return this._filteredRows=r,this}{let e=this._collection._data.length;for(;e--;)!0===t(this._collection._data[e])&&r.push(e);return this._filteredRows=r,this._filterInitialized=!0,this}}count(){return this._filterInitialized?this._filteredRows.length:this._collection.count()}data(e={}){let t,r,n;({forceClones:t=!1,forceCloneMethod:r=this._collection._cloneMethod,removeMeta:n=!1}=e);let o,l,h=[],data=this._collection._data;if(n&&!t&&(t=!0,r="shallow"),this._collection._disableDeltaChangesApi||(t=!0,r="deep"),!this._filterInitialized){if(0===this._filteredRows.length){if(this._collection._cloneObjects||t){l=r;for(let i=0;i<data.length;i++)o=this._collection._defineNestedProperties(c(data[i],l)),n&&(delete o.$loki,delete o.meta),h.push(o);return h}return data.slice()}this._filterInitialized=!0}const d=this._filteredRows;if(this._collection._cloneObjects||t){l=r;for(let i=0;i<d.length;i++)o=this._collection._defineNestedProperties(c(data[d[i]],l)),n&&(delete o.$loki,delete o.meta),h.push(o)}else for(let i=0;i<d.length;i++)h.push(data[d[i]]);return h}update(e){this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex());const t=this._filteredRows.length,r=this._collection._data;for(let n=0;n<t;n++)if(this._collection._cloneObjects||!this._collection._disableDeltaChangesApi){const t=c(r[this._filteredRows[n]],this._collection._cloneMethod);e(t),this._collection.update(t)}else e(r[this._filteredRows[n]]),this._collection.update(r[this._filteredRows[n]]);return this}remove(){return this._filterInitialized||0!==this._filteredRows.length||(this._filteredRows=this._collection._prepareFullDocIndex()),this._collection.remove(this.data()),this._filteredRows=[],this}mapReduce(e,t){try{return t(this.data().map(e))}catch(e){throw e}}eqJoin(e,t,r,n,o){let l,h,d=[],c=[],_="function"==typeof t,f="function"==typeof r,m={},v=this.data(o),y=v.length;if(e instanceof R)d=e.chain().data(o);else if(e instanceof w)d=e.data(o);else{if(!Array.isArray(e))throw new TypeError("joinData needs to be an array or result set");d=e}l=d.length;for(let i=0;i<l;i++)h=f?r(d[i]):d[i][r],m[h]=d[i];n||(n=(e,t)=>({left:e,right:t}));for(let e=0;e<y;e++)h=_?t(v[e]):v[e][t],c.push(n(v[e],m[h]||{}));return this._collection=new R("joinData"),this._collection.insert(c),this._filteredRows=[],this._filterInitialized=!1,this}map(e,t){const data=this.data(t).map(e);return this._collection=new R("mappedData"),this._collection.insert(data),this._filteredRows=[],this._filterInitialized=!1,this}}class y extends n.a{constructor(e,t,r={}){super(),this._rebuildPending=!1,this._resultData=[],this._resultDirty=!1,this._cachedResultSet=null,this._filterPipeline=[],this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._sortDirty=!1,({persistent:this._persistent=!1,sortPriority:this._sortPriority="passive",minRebuildInterval:this._minRebuildInterval=1}=r),this._collection=e,this.name=t,this._resultSet=new w(e),this._events={rebuild:[]}}_rematerialize({removeWhereFilters:e=!1}){if(this._resultData=[],this._resultDirty=!0,this._resultSet=new w(this._collection),(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||null!==this._sortByScoring)&&(this._sortDirty=!0),e){let e=this._filterPipeline.length;for(;e--;)"where"===this._filterPipeline[e].type&&(e!==this._filterPipeline.length-1&&(this._filterPipeline[e]=this._filterPipeline[this._filterPipeline.length-1]),this._filterPipeline.length--)}const t=this._filterPipeline;this._filterPipeline=[];for(let e=0;e<t.length;e++)this.applyFind(t[e].val);return this.data(),this.emit("rebuild",this),this}branchResultSet(e,t){const r=this._resultSet.copy();return void 0===e?r:r.transform(e,t)}toJSON(){return{name:this.name,_persistent:this._persistent,_sortPriority:this._sortPriority,_minRebuildInterval:this._minRebuildInterval,_resultSet:this._resultSet,_filterPipeline:this._filterPipeline,_sortCriteria:this._sortCriteria,_sortCriteriaSimple:this._sortCriteriaSimple,_sortByScoring:this._sortByScoring,_sortDirty:this._sortDirty}}static fromJSONObject(e,t){let r=new y(e,t.name);return r._resultDirty=!0,r._filterPipeline=t._filterPipeline,r._resultData=[],r._sortCriteria=t._sortCriteria,r._sortCriteriaSimple=t._sortCriteriaSimple,r._sortByScoring=t._sortByScoring,r._sortDirty=t._sortDirty,r._resultSet._filteredRows=t._resultSet._filteredRows,r._resultSet._filterInitialized=t._resultSet._filterInitialized,r._rematerialize({removeWhereFilters:!0}),r}removeFilters({queueSortPhase:e=!1}={}){this._rebuildPending=!1,this._resultSet.reset(),this._resultData=[],this._resultDirty=!0,this._cachedResultSet=null,this._filterPipeline=[],this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._sortDirty=!1,!0===e&&this._queueSortPhase()}applySort(e){return this._sortFunction=e,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=null,this._queueSortPhase(),this}applySimpleSort(e,t=!1){return this._sortCriteriaSimple={field:e,options:t},this._sortFunction=null,this._sortCriteria=null,this._sortByScoring=null,this._queueSortPhase(),this}applySortCriteria(e){return this._sortCriteria=e,this._sortCriteriaSimple=null,this._sortFunction=null,this._sortByScoring=null,this._queueSortPhase(),this}applySortByScoring(e=!1){return this._sortFunction=null,this._sortCriteria=null,this._sortCriteriaSimple=null,this._sortByScoring=e,this._queueSortPhase(),this}getScoring(){return this._resultSet.getScoring()}startTransaction(){return this._cachedResultSet=this._resultSet.copy(),this}commit(){return this._cachedResultSet=null,this}rollback(){return this._resultSet=this._cachedResultSet,this._persistent&&(this._resultData=this._resultSet.data(),this.emit("rebuild",this)),this}_indexOfFilterWithId(e){if("string"==typeof e||"number"==typeof e)for(let t=0,r=this._filterPipeline.length;t<r;t++)if(e===this._filterPipeline[t].uid)return t;return-1}_addFilter(filter){this._filterPipeline.push(filter),this._resultSet[filter.type](filter.val)}reapplyFilters(){this._resultSet.reset(),this._cachedResultSet=null,this._persistent&&(this._resultData=[],this._resultDirty=!0);const e=this._filterPipeline;this._filterPipeline=[];for(let t=0,r=e.length;t<r;t++)this._addFilter(e[t]);return this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||null!==this._sortByScoring?this._queueSortPhase():this._queueRebuildEvent(),this}applyFilter(filter){const e=this._indexOfFilterWithId(filter.uid);return e>=0?(this._filterPipeline[e]=filter,this.reapplyFilters()):(this._cachedResultSet=null,this._persistent&&(this._resultData=[],this._resultDirty=!0),this._addFilter(filter),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple||null!==this._sortByScoring?this._queueSortPhase():this._queueRebuildEvent(),this)}applyFind(e,t=""){return this.applyFilter({type:"find",val:e,uid:t}),this}applyWhere(e,t){return this.applyFilter({type:"where",val:e,uid:t}),this}removeFilter(e){const t=this._indexOfFilterWithId(e);if(t<0)throw new Error("Dynamic view does not contain a filter with ID: "+e);return this._filterPipeline.splice(t,1),this.reapplyFilters(),this}count(){return this._resultDirty&&(this._resultData=this._resultSet.data()),this._resultSet.count()}data(e={}){return(this._sortDirty||this._resultDirty)&&this._performSortPhase({suppressRebuildEvent:!0}),this._persistent?this._resultData:this._resultSet.data(e)}_queueRebuildEvent(){this._rebuildPending||(this._rebuildPending=!0,setTimeout((()=>{this._rebuildPending&&(this._rebuildPending=!1,this.emit("rebuild",this))}),this._minRebuildInterval))}_queueSortPhase(){this._sortDirty||(this._sortDirty=!0,"active"===this._sortPriority?setTimeout((()=>{this._performSortPhase()}),this._minRebuildInterval):this._queueRebuildEvent())}_performSortPhase(e={}){(this._sortDirty||this._resultDirty)&&(this._sortDirty&&(this._sortFunction?this._resultSet.sort(this._sortFunction):this._sortCriteria?this._resultSet.compoundsort(this._sortCriteria):this._sortCriteriaSimple?this._resultSet.simplesort(this._sortCriteriaSimple.field,this._sortCriteriaSimple.options):null!==this._sortByScoring&&this._resultSet.sortByScoring(this._sortByScoring),this._sortDirty=!1),this._persistent&&(this._resultData=this._resultSet.data(),this._resultDirty=!1),e.suppressRebuildEvent||this.emit("rebuild",this))}_evaluateDocument(e,t){if(!this._resultSet._filterInitialized)return this._persistent&&(this._resultData=this._resultSet.data()),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent());const r=this._resultSet._filteredRows,n=t?-1:r.indexOf(+e),o=r.length,l=new w(this._collection);let filter;l._filteredRows=[e],l._filterInitialized=!0;for(let e=0,t=this._filterPipeline.length;e<t;e++)filter=this._filterPipeline[e],l[filter.type](filter.val);const h=0===l._filteredRows.length?-1:0;return-1!==n||-1!==h?-1===n&&-1!==h?(r.push(e),this._persistent&&this._resultData.push(this._collection._data[e]),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent())):-1!==n&&-1===h?(n<o-1?(r.splice(n,1),this._persistent&&this._resultData.splice(n,1)):(r.length=o-1,this._persistent&&(this._resultData.length=o-1)),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent())):void(-1!==n&&-1!==h&&(this._persistent&&(this._resultData[n]=this._collection._data[e]),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent())):void 0}_removeDocument(e){if(!this._resultSet._filterInitialized)return this._persistent&&(this._resultData=this._resultSet.data()),void(this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent());const t=this._resultSet._filteredRows,r=t.indexOf(+e);let n=t.length;-1!==r&&(r<n-1?(t[r]=t[n-1],t.length=n-1,this._persistent&&(this._resultData[r]=this._resultData[n-1],this._resultData.length=n-1)):(t.length=n-1,this._persistent&&(this._resultData.length=n-1)),this._sortFunction||this._sortCriteria||this._sortCriteriaSimple?this._queueSortPhase():this._queueRebuildEvent()),n=t.length;for(let r=0;r<n;r++)t[r]>e&&t[r]--}mapReduce(e,t){try{return t(this.data().map(e))}catch(e){throw e}}}var x=r(4),S=r(1);function I(e){return e.reduce(((a,b)=>a+b),0)/e.length}function k(e,path,t,r=0){if(void 0===e)return!1;if(r+1===path.length)return t.push(e[path[r]]),!1;const n=e[path[r]];if(Array.isArray(n)){for(let i=0;i<n.length;i++)k(n[i],path,t,r+1);return!0}return k(n,path,t,r+1)}r.d(t,"a",(function(){return R}));class R extends n.a{constructor(e,t={}){if(super(),this._data=[],this._idIndex=[],this._rangedIndexes={},this._lokimap={},this._unindexedSortComparator="js",this._defaultLokiOperatorPackage="js",this._constraints={unique:{}},this._transforms={},this._dirty=!0,this._cached=null,this._nestedProperties=[],this._ttl={age:null,ttlInterval:null,daemon:null},this._maxId=0,this._dynamicViews=[],this._changes=[],this._stages={},this._commitLog=[],t&&!0===t.disableMeta){if(!1===t.disableChangesApi)throw new Error("disableMeta option cannot be passed as true when disableChangesApi is passed as false");if(!1===t.disableDeltaChangesApi)throw new Error("disableMeta option cannot be passed as true when disableDeltaChangesApi is passed as false");if("number"==typeof t.ttl&&t.ttl>0)throw new Error("disableMeta option cannot be passed as true when ttl is enabled")}if(this.name=e,this._unindexedSortComparator=t.unindexedSortComparator||"js",this._defaultLokiOperatorPackage=t.defaultLokiOperatorPackage||"js",void 0!==t.unique&&(Array.isArray(t.unique)||(t.unique=[t.unique]),t.unique.forEach((e=>{this._constraints.unique[e]=new o(e)}))),void 0!==S.a.FullTextSearch?this._fullTextSearch=void 0!==t.fullTextSearch?new S.a.FullTextSearch(t.fullTextSearch):null:this._fullTextSearch=null,this._transactional=void 0!==t.transactional&&t.transactional,this._cloneObjects=void 0!==t.clone&&t.clone,this._asyncListeners=void 0!==t.asyncListeners&&t.asyncListeners,this._disableMeta=void 0!==t.disableMeta&&t.disableMeta,this._disableChangesApi=void 0===t.disableChangesApi||t.disableChangesApi,this._disableDeltaChangesApi=void 0===t.disableDeltaChangesApi||t.disableDeltaChangesApi,this._cloneMethod=void 0!==t.cloneMethod?t.cloneMethod:"deep",this._disableChangesApi&&(this._disableDeltaChangesApi=!0),this._serializableIndexes=void 0===t.serializableIndexes||t.serializableIndexes,null!=t.nestedProperties)for(let i=0;i<t.nestedProperties.length;i++){const e=t.nestedProperties[i];"string"==typeof e?this._nestedProperties.push({name:e,path:e.split(".")}):this._nestedProperties.push(e)}this.setTTL(t.ttl||-1,t.ttlInterval),this._events={insert:[],update:[],"pre-insert":[],"pre-update":[],close:[],flushbuffer:[],error:[],delete:[],warning:[]},this._ensureId();let r=t.rangedIndexes||{};for(let e in r)this.ensureRangedIndex(e,r[e].indexTypeName,r[e].comparatorName);this.setChangesApi(this._disableChangesApi,this._disableDeltaChangesApi),this.flushChanges()}toJSON(){return{name:this.name,unindexedSortComparator:this._unindexedSortComparator,defaultLokiOperatorPackage:this._defaultLokiOperatorPackage,_dynamicViews:this._dynamicViews,uniqueNames:Object.keys(this._constraints.unique),transforms:this._transforms,rangedIndexes:this._rangedIndexes,_data:this._data,idIndex:this._idIndex,maxId:this._maxId,_dirty:this._dirty,_nestedProperties:this._nestedProperties,transactional:this._transactional,asyncListeners:this._asyncListeners,disableMeta:this._disableMeta,disableChangesApi:this._disableChangesApi,disableDeltaChangesApi:this._disableDeltaChangesApi,cloneObjects:this._cloneObjects,cloneMethod:this._cloneMethod,changes:this._changes,_fullTextSearch:this._fullTextSearch}}static fromJSONObject(e,t){let r=new R(e.name,{disableChangesApi:e.disableChangesApi,disableDeltaChangesApi:e.disableDeltaChangesApi,unindexedSortComparator:e.unindexedSortComparator,defaultLokiOperatorPackage:e.defaultLokiOperatorPackage});if(r._transactional=e.transactional,r._asyncListeners=e.asyncListeners,r._disableMeta=e.disableMeta,r._disableChangesApi=e.disableChangesApi,r._cloneObjects=e.cloneObjects,r._cloneMethod=e.cloneMethod||"deep",r._changes=e.changes,r._nestedProperties=e._nestedProperties,r._rangedIndexes=e.rangedIndexes||{},r._dirty=!(!t||!0!==t.retainDirtyFlags)&&e._dirty,t&&void 0!==t[e.name]){let n=function(e){const r=t[e.name];if(r.proto){const e=r.inflate||((e,t)=>{for(let r in e)t[r]=e[r]});return data=>{const t=new r.proto;return e(data,t),t}}return r.inflate}(e);for(let t=0;t<e._data.length;t++)r._data[t]=r._defineNestedProperties(n(e._data[t])),r._lokimap[r._data[t].$loki]=r._data[t]}else for(let t=0;t<e._data.length;t++)r._data[t]=r._defineNestedProperties(e._data[t]),r._lokimap[r._data[t].$loki]=r._data[t];r._maxId=void 0===e.maxId?0:e.maxId,r._idIndex=e.idIndex,void 0!==e.transforms&&(r._transforms=e.transforms);for(let t in e.rangedIndexes){let n=e.rangedIndexes[t],o=(0,x.a[n.indexTypeName])(t,f.a[n.comparatorName]);o.restore(n.index),r._rangedIndexes[t].index=o}if(r._ensureId(),void 0!==e.uniqueNames)for(let t=0;t<e.uniqueNames.length;t++)r.ensureUniqueIndex(e.uniqueNames[t]);if(void 0!==e._dynamicViews)for(let t=0;t<e._dynamicViews.length;t++)r._dynamicViews.push(y.fromJSONObject(r,e._dynamicViews[t]));return e._fullTextSearch&&(r._fullTextSearch=S.a.FullTextSearch.fromJSONObject(e._fullTextSearch,t.fullTextSearch)),r}addTransform(e,t){if(void 0!==this._transforms[e])throw new Error("a transform by that name already exists");this._transforms[e]=t}getTransform(e){return this._transforms[e]}setTransform(e,t){this._transforms[e]=t}removeTransform(e){delete this._transforms[e]}setTTL(e,t){e<0?clearInterval(this._ttl.daemon):(this._ttl.age=e,this._ttl.ttlInterval=t,this._ttl.daemon=setInterval((()=>{const e=Date.now();this.chain().where((t=>{const r=t.meta.updated||t.meta.created,n=e-r;return this._ttl.age<n})).remove()}),t))}_prepareFullDocIndex(){const e=new Array(this._data.length);for(let i=0;i<e.length;i++)e[i]=i;return e}ensureIndex(e,t,r){this.ensureRangedIndex(e,t,r)}ensureRangedIndex(e,t,r){if(t=t||"avl",r=r||"loki",!x.a[t])throw new Error("ensureRangedIndex: Unknown range index type");if(!f.a[r])throw new Error("ensureRangedIndex: Unknown comparator");let n=x.a[t],o=f.a[r];this._rangedIndexes[e]={index:n(e,o),indexTypeName:t,comparatorName:r};let l=this._rangedIndexes[e].index;for(let i=0;i<this._data.length;i++)l.insert(this._data[i].$loki,this._data[i][e])}ensureUniqueIndex(e){let t=new o(e);this._constraints.unique[e]=t;for(let i=0;i<this._data.length;i++)t.set(this._data[i].$loki,this._data[i][e]);return t}count(e){return e?this.chain().find(e)._filteredRows.length:this._data.length}_ensureId(){this._idIndex=[];for(let i=0;i<this._data.length;i++)this._idIndex.push(this._data[i].$loki)}addDynamicView(e,t){const r=new y(this,e,t);return this._dynamicViews.push(r),r}removeDynamicView(e){for(let t=0;t<this._dynamicViews.length;t++)this._dynamicViews[t].name===e&&this._dynamicViews.splice(t,1)}getDynamicView(e){for(let t=0;t<this._dynamicViews.length;t++)if(this._dynamicViews[t].name===e)return this._dynamicViews[t];return null}findAndUpdate(e,t){this.chain().find(e).update(t)}findAndRemove(e){this.chain().find(e).remove()}insert(e){if(!Array.isArray(e))return this.insertOne(e);let t,r=[];this.emit("pre-insert",e);for(let i=0;i<e.length;i++){if(t=this.insertOne(e[i],!0),!t)return;r.push(t)}return this.emit("insert",r),r=this._cloneObjects?c(r,this._cloneMethod):r,1===r.length?r[0]:r}insertOne(e,t=!1){let r,n=null;if("object"!=typeof e?n=new TypeError("Document needs to be an object"):null===e&&(n=new TypeError("Object cannot be null")),null!==n)throw this.emit("error",n),n;const o=this._defineNestedProperties(this._cloneObjects?c(e,this._cloneMethod):e);if(this._disableMeta||void 0!==o.meta||(o.meta={version:0,revision:0,created:0}),t||this.emit("pre-insert",o),this._add(o))return this._disableChangesApi?this._insertMeta(o):this._insertMetaWithChange(o),r=this._cloneObjects?c(o,this._cloneMethod):o,t||this.emit("insert",r),r}_defineNestedProperties(data){for(let i=0;i<this._nestedProperties.length;i++){const e=this._nestedProperties[i].name,path=this._nestedProperties[i].path;Object.defineProperty(data,e,{get(){const e=[];return k(this,path,e)?e:e[0]},set(e){path.slice(0,path.length-1).reduce(((e,t)=>e&&e[t]?e[t]:null),this)[path[path.length-1]]=e},enumerable:!1,configurable:!0})}return data}clear({removeIndices:e=!1}={}){if(this._data=[],this._idIndex=[],this._cached=null,this._maxId=0,this._dynamicViews=[],this._dirty=!0,!0===e)this._rangedIndexes={},this._constraints={unique:{}};else{for(let e in this._rangedIndexes)this.ensureRangedIndex(e,this._rangedIndexes[e].indexTypeName,this._rangedIndexes[e].comparatorName);const e=Object.keys(this._constraints.unique);for(let i=0;i<e.length;i++)this._constraints.unique[e[i]].clear()}null!==this._fullTextSearch&&this._fullTextSearch.clear()}update(e){if(Array.isArray(e))for(let i=0;i<e.length;i++)this.update(e[i]);else{if(void 0===e.$loki)throw new Error("Trying to update unsynced document. Please save the document first by using insert() or addMany()");try{this.startTransaction();const t=this.get(e.$loki,!0);if(!t)throw new Error("Trying to update a document not in collection.");let r=t[0],n=t[1],o=this._defineNestedProperties(this._cloneObjects||!this._disableDeltaChangesApi?c(e,this._cloneMethod):e);this.emit("pre-update",e),Object.keys(this._constraints.unique).forEach((e=>{this._constraints.unique[e].update(o.$loki,o[e])})),this._data[n]=o,this._lokimap[e.$loki]=o;for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e]._evaluateDocument(n,!1);for(let t in this._rangedIndexes)this._rangedIndexes[t].index.update(e.$loki,e[t]);this._idIndex[n]=o.$loki,null!==this._fullTextSearch&&this._fullTextSearch.updateDocument(e,n),this.commit(),this._dirty=!0,this._disableChangesApi?this._updateMeta(o):this._updateMetaWithChange(o,r);let l=o;this._cloneObjects&&(l=c(o,this._cloneMethod)),this.emit("update",l,r)}catch(e){throw this.rollback(),this.emit("error",e),e}}}_add(e){if("object"!=typeof e)throw new TypeError("Object being added needs to be an object");if(void 0!==e.$loki)throw new Error("Document is already in collection, please use update()");try{this.startTransaction(),this._maxId++,isNaN(this._maxId)&&(this._maxId=this._data[this._data.length-1].$loki+1);const t=e;t.$loki=this._maxId,this._disableMeta||(t.meta.version=0);const r=this._constraints.unique;for(const e in r)void 0!==r[e]&&r[e].set(t.$loki,t[e]);this._idIndex.push(t.$loki),this._lokimap[t.$loki]=t,this._data.push(t);const n=this._data.length-1,o=this._dynamicViews.length;for(let i=0;i<o;i++)this._dynamicViews[i]._evaluateDocument(n,!0);for(let r in this._rangedIndexes)this._serializableIndexes&&t[r]instanceof Date&&(t[r]=t[r].getTime()),this._rangedIndexes[r].index.insert(e.$loki,e[r]);return null!==this._fullTextSearch&&this._fullTextSearch.addDocument(t,n),this.commit(),this._dirty=!0,this._cloneObjects?c(t,this._cloneMethod):t}catch(e){throw this.rollback(),this.emit("error",e),e}}updateWhere(e,t){const r=this.where(e);try{for(let i=0;i<r.length;i++)this.update(t(r[i]))}catch(e){throw this.rollback(),e}}removeWhere(e){this.remove(this._data.filter(e))}removeDataOnly(){this.remove(this._data.slice())}remove(e){if("number"==typeof e&&(e=this.get(e)),Array.isArray(e)){let t=0;const r=e.length;for(;t<r;t++)this.remove(e[t])}else{if(void 0===e.$loki)throw new Error("Object is not a document stored in the collection");try{this.startTransaction();const t=this.get(e.$loki,!0),r=t[1];let n="number"==typeof e?this.get(e):e;Object.keys(this._constraints.unique).forEach((e=>{e in n&&this._constraints.unique[e].remove(n.$loki)}));for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e]._removeDocument(r);this._data.splice(r,1),this._idIndex.splice(r,1),delete this._lokimap[e.$loki];for(let t in this._rangedIndexes)this._rangedIndexes[t].index.remove(e.$loki);null!==this._fullTextSearch&&this._fullTextSearch.removeDocument(e,r),this.commit(),this._dirty=!0,this._disableChangesApi||this._createChange(this.name,"R",t[0]),this.emit("delete",t[0]),delete e.$loki,delete e.meta}catch(e){throw this.rollback(),this.emit("error",e),e}}}getChanges(){return this._changes}setChangesApi(e,t=!0){this._disableChangesApi=e,this._disableDeltaChangesApi=!!e||t}flushChanges(){this._changes=[]}_getObjectDelta(e,t){const r=null!==t&&"object"==typeof t?Object.keys(t):null;if(r&&r.length&&["string","boolean","number"].indexOf(typeof t)<0){const n={};for(let i=0;i<r.length;i++){const o=r[i];if(t.hasOwnProperty(o))if(e.hasOwnProperty(o)&&void 0===this._constraints.unique[o]&&"$loki"!==o&&"meta"!==o){const r=this._getObjectDelta(e[o],t[o]);void 0!==r&&r!=={}&&(n[o]=r)}else n[o]=t[o]}return 0===Object.keys(n).length?void 0:n}return e===t?void 0:t}_getChangeDelta(e,t){return t?this._getObjectDelta(t,e):JSON.parse(JSON.stringify(e))}_createChange(e,t,r,n){this._changes.push({name:e,operation:t,obj:"U"!==t||this._disableDeltaChangesApi?JSON.parse(JSON.stringify(r)):this._getChangeDelta(r,n)})}_createInsertChange(e){this._createChange(this.name,"I",e)}_createUpdateChange(e,t){this._createChange(this.name,"U",e,t)}_insertMetaWithChange(e){this._insertMeta(e),this._createInsertChange(e)}_updateMetaWithChange(e,t){this._updateMeta(e),this._createUpdateChange(e,t)}_insertMeta(e){this._disableMeta||(e.meta||(e.meta={version:0,revision:0,created:0}),e.meta.created=(new Date).getTime(),e.meta.revision=0)}_updateMeta(e){this._disableMeta||(e.meta.updated=(new Date).getTime(),e.meta.revision+=1)}get(e,t=!1){if(!t){let t=this._lokimap[e];return void 0===t?null:t}const data=this._idIndex;let r=data.length-1,n=0,o=n+r>>1;if(e="number"==typeof e?e:parseInt(e,10),isNaN(e))throw new TypeError("Passed id is not an integer");for(;data[n]<data[r];)o=n+r>>1,data[o]<e?n=o+1:r=o;return r===n&&data[n]===e?t?[this._data[n],n]:this._data[n]:null}by(e,t){let r=this._constraints.unique[e].get(t);return this._cloneObjects?c(this._lokimap[r],this._cloneMethod):this._lokimap[r]}findOne(e){e=e||{};const t=this.chain().find(e,!0).data();return Array.isArray(t)&&0===t.length?null:this._cloneObjects?c(t[0],this._cloneMethod):t[0]}chain(e,t){const r=new w(this);return void 0===e?r:r.transform(e,t)}find(e){return this.chain().find(e).data()}findOneUnindexed(e,t){let r,i=this._data.length;for(;i--;)if(this._data[i][e]===t)return r=this._data[i],r;return null}startTransaction(){if(this._transactional){let e={};for(let t in this._rangedIndexes)e[t].indexTypeName=this._rangedIndexes[t].indexTypeName,e[t].comparatorName=this._rangedIndexes[t].comparatorName,e[t].index=this._rangedIndexes[t].index.backup();this._cached={index:this._idIndex,data:c(this._data,this._cloneMethod),rangedIndexes:e};for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e].startTransaction()}}commit(){if(this._transactional){this._cached=null;for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e].commit()}}rollback(){if(this._transactional&&null!==this._cached){this._idIndex=this._cached.index,this._data=this._cached.data;for(let i=0;i<this._data.length;i++)this._data[i]=this._defineNestedProperties(this._data[i]);for(let e in this._cached.rangedIndexes){let t=this._cached.rangedIndexes[e],r=(0,x.a[t.indexTypeName])(e,f.a[t.comparatorName]);r.restore(t.index),this._rangedIndexes[e].index=r}for(let e=0;e<this._dynamicViews.length;e++)this._dynamicViews[e].rollback()}}where(e){return this.chain().where(e).data()}mapReduce(e,t){return t(this._data.map(e))}eqJoin(e,t,r,n,o){return new w(this).eqJoin(e,t,r,n,o)}getStage(e){return this._stages[e]||(this._stages[e]={}),this._stages[e]}stage(e,t){const r=JSON.parse(JSON.stringify(t));return this.getStage(e)[t.$loki]=r,r}commitStage(e,t){const r=this.getStage(e),n=(new Date).getTime();for(const e in r)this.update(r[e]),this._commitLog.push({timestamp:n,message:t,data:JSON.parse(JSON.stringify(r[e]))});this._stages[e]={}}extract(e){const t=[];for(let i=0;i<this._data.length;i++)t.push(this._data[i][e]);return t}min(e){return Math.min.apply(null,this.extractNumerical(e))}max(e){return Math.max.apply(null,this.extractNumerical(e))}minRecord(e){const t={index:0,value:0};if(0===this._data.length)return t.index=null,t.value=null,t;t.index=this._data[0].$loki,t.value=parseFloat(this._data[0][e]);for(let i=1;i<this._data.length;i++){const r=parseFloat(this._data[i][e]);t.value>r&&(t.value=r,t.index=this._data[i].$loki)}return t}maxRecord(e){const t={index:0,value:0};if(0===this._data.length)return t.index=null,t.value=null,t;t.index=this._data[0].$loki,t.value=parseFloat(this._data[0][e]);for(let i=1;i<this._data.length;i++){const r=parseFloat(this._data[i][e]);t.value<r&&(t.value=r,t.index=this._data[i].$loki)}return t}extractNumerical(e){return this.extract(e).map(parseFloat).filter(Number).filter((e=>!isNaN(e)))}avg(e){return I(this.extractNumerical(e))}stdDev(e){return function(e){const t=I(e),r=I(e.map((e=>{const r=e-t;return r*r})));return Math.sqrt(r)}(this.extractNumerical(e))}mode(e){const t={},data=this.extractNumerical(e);let r=data[0],n=-1/0;for(let i=0;i<data.length;i++){const e=data[i];t[e]?t[e]++:t[e]=1,t[e]>n&&(r=e,n=t[e])}return r}median(e){const t=this.extractNumerical(e);t.sort(((a,b)=>a-b));const r=Math.floor(t.length/2);return t.length%2?t[r]:(t[r-1]+t[r])/2}}},function(e,t,r){"use strict";class n{constructor(e,t){this.nodes={},this.apex=null,this.name=e,this.comparator=t}backup(){let e=new n(this.name,this.comparator);return e.nodes=JSON.parse(JSON.stringify(this.nodes)),e.apex=this.apex,e}restore(e){this.name=e.name,this.comparator=e.comparator,this.nodes=JSON.parse(JSON.stringify(e.nodes)),this.apex=e.apex}insert(e,t){if(e<=0)throw new Error("avl index ids are required to be numbers greater than zero");let r=this.nodes[e]={id:e,value:t,parent:null,balance:0,height:0,left:null,right:null,siblings:[]};this.apex?this.insertNode(this.nodes[this.apex],r):this.apex=e}insertNode(e,t){switch(this.comparator(t.value,e.value)){case 0:e.siblings.push(t.id),t.parent=e.id;break;case 1:e.right?(this.insertNode(this.nodes[e.right],t),this.updateBalance(e)):(e.right=t.id,t.parent=e.id,this.updateBalance(e));break;case-1:e.left?(this.insertNode(this.nodes[e.left],t),this.updateBalance(e)):(e.left=t.id,t.parent=e.id,this.updateBalance(e));break;default:throw new Error("Invalid comparator result")}if(e.balance<-1){if(null===e.left)throw new Error("insertNode.balance() : left child should not be null");this.nodes[e.left].balance<=0?this.leftLeftCase(e):this.leftRightCase(e)}if(e.balance>1){if(null===e.right)throw new Error("insertNode.balance() : right child should not be null");this.nodes[e.right].balance>=0?this.rightRightCase(e):this.rightLeftCase(e)}return e.height}updateBalance(e){let t=e.left?this.nodes[e.left].height:-1,hr=e.right?this.nodes[e.right].height:-1;e.height=t>hr?1+t:1+hr,e.balance=hr-t}leftLeftCase(e){return this.rotateRight(e)}leftRightCase(e){if(!e.left)throw new Error("leftRightCase: left child not set");return e.left=this.rotateLeft(this.nodes[e.left]).id,this.rotateRight(e)}rightRightCase(e){return this.rotateLeft(e)}rightLeftCase(e){if(!e.right)throw new Error("rightLeftCase: right child not set");return e.right=this.rotateRight(this.nodes[e.right]).id,this.rotateLeft(e)}rotateLeft(e){if(!e.right)throw new Error("rotateLeft: right child was unavailable.");let t=e.parent?this.nodes[e.parent]:null,r=this.nodes[e.right];if(e.right=r.left,e.right&&(this.nodes[e.right].parent=e.id),r.left=e.id,r.parent=e.parent,e.parent=r.id,t)if(t.left===e.id)t.left=r.id;else{if(t.right!==e.id)throw new Error("rotateLeft() : attempt to remap parent back to child failed... not found");t.right=r.id}else{if(this.apex!==e.id)throw new Error("rightRotate expecting parentless node to be apex");this.apex=r.id}return this.updateBalance(e),this.updateBalance(r),r}rotateRight(e){if(!e.left)throw new Error("rotateRight : left child unavailable");let t=e.parent?this.nodes[e.parent]:null,r=this.nodes[e.left];if(e.left=r.right,r.right&&(this.nodes[r.right].parent=e.id),r.right=e.id,r.parent=e.parent,e.parent=r.id,t)t.left===e.id?t.left=r.id:t.right=r.id;else{if(this.apex!==e.id)throw new Error("rightRotate expecting parentless node to be apex");this.apex=r.id}return this.updateBalance(e),this.updateBalance(r),r}getValuesAsTree(e){return null===this.apex?null:{id:(e=e||this.nodes[this.apex]).id,val:e.value,siblings:e.siblings,balance:e.balance,height:e.height,left:e.left?this.getValuesAsTree(this.nodes[e.left]):null,right:e.right?this.getValuesAsTree(this.nodes[e.right]):null}}update(e,t){let r=this.nodes[e];0!==this.comparator(r.value,t)&&(this.remove(e),this.insert(e,t))}remove(e){if(!this.apex)throw new Error("remove() : attempting remove when tree has no apex");this.removeNode(this.nodes[this.apex],e)}removeNode(e,t){if(!this.nodes[t])throw new Error("removeNode: attempting to remove a node which is not in hashmap");let r=this.nodes[t].value;switch(this.comparator(r,e.value)){case 0:if(e.siblings.length>0){if(e.id===t){let r=e.siblings.shift(),n=this.nodes[r];n.parent=e.parent,this.updateChildLink(e.parent,t,r),e.left&&(this.nodes[e.left].parent=r),e.right&&(this.nodes[e.right].parent=r),n.left=e.left,n.right=e.right,n.siblings=e.siblings,n.height=e.height,n.balance=e.balance,this.apex===t&&(this.apex=r);for(let e of n.siblings)this.nodes[e].parent=r;return void delete this.nodes[t]}{let r=e.siblings.indexOf(t);if(-1===r)throw new Error("Unable to remove sibling from parented sibling");return e.siblings.splice(r,1),void delete this.nodes[t]}}return e.left||e.right?e.left&&e.right?void this.promoteSuccessor(e):(e.left&&(this.promoteChild(e,this.nodes[e.left]),this.apex===t&&(this.apex=e.left)),void(e.right&&(this.promoteChild(e,this.nodes[e.right]),this.apex===t&&(this.apex=e.right)))):(this.updateChildLink(e.parent,e.id,null),delete this.nodes[t],void(t===this.apex&&(this.apex=null)));case 1:if(!e.right)throw new Error("removeNode: Unable to find value in tree");this.removeNode(this.nodes[e.right],t);break;case-1:if(!e.left)throw new Error("removeNode: Unable to find value in tree");this.removeNode(this.nodes[e.left],t)}if(this.updateBalance(e),e.balance<-1){if(null===e.left)throw new Error("insertNode.balance() : left child should not be null");this.nodes[e.left].balance<=0?this.leftLeftCase(e):this.leftRightCase(e)}if(e.balance>1){if(null===e.right)throw new Error("insertNode.balance() : right child should not be null");this.nodes[e.right].balance>=0?this.rightRightCase(e):this.rightLeftCase(e)}}updateChildLink(e,t,r){if(null===e)return;let n=this.nodes[e];n.left===t?n.left=r:n.right===t&&(n.right=r)}promoteChild(e,t){let r=e.parent;if(r){let n=this.nodes[r];n.left===e.id?n.left=t.id:n.right===e.id&&(n.right=t.id)}t.parent=r,delete this.nodes[e.id]}promoteSuccessor(e){let t=e.id;if(!e.right||!e.left)throw new Error("promoteSuccessor() : node to replace does not have two children");let r,n,o,l=null;if(e.balance<0){let t=this.nodes[e.left];l=this.findGreaterLeaf(t),r=l.id,n=l.value,o=l.siblings,l.siblings=[],this.removeNode(t,r)}else{let t=this.nodes[e.right];l=this.findLesserLeaf(t),r=l.id,n=l.value,o=l.siblings,l.siblings=[],this.removeNode(t,r)}if(e.parent){let p=this.nodes[e.parent];p.left===t&&(p.left=r),p.right===t&&(p.right=r)}e.left&&(this.nodes[e.left].parent=r),e.right&&(this.nodes[e.right].parent=r),e.id=r,e.value=n,e.siblings=o,this.nodes[r]=e,delete this.nodes[t],this.apex===t&&(this.apex=r),this.updateBalance(e)}findGreaterLeaf(e){if(!e.right)return e;let t=this.findGreaterLeaf(this.nodes[e.right]);return t||e}findLesserLeaf(e){if(!e.left)return e;let t=this.findLesserLeaf(this.nodes[e.left]);return t||e}rangeRequest(e){if(!this.apex)return[];if(!e)return this.collateIds(this.nodes[this.apex]);if("$eq"===e.op){let t=this.locate(this.nodes[this.apex],e.val);return null===t?[]:t.siblings.length?[t.id,...t.siblings]:[t.id]}return this.collateRequest(this.nodes[this.apex],e)}collateRequest(e,t){let r=[];if("$eq"===t.op)throw new Error("collateRequest does not support $eq range request");let n=this.comparator(e.value,t.val),o=0;if("$between"===t.op){if(null===t.high||void 0===t.high)throw new Error("collateRequest: $between request missing high range value");o=this.comparator(e.value,t.high)}if(e.left)switch(t.op){case"$lt":case"$lte":r=this.collateRequest(this.nodes[e.left],t);break;case"$gt":case"$gte":case"$between":1===n&&(r=this.collateRequest(this.nodes[e.left],t))}if(t)switch(t.op){case"$lt":-1===n&&(r.push(e.id),r.push(...e.siblings));break;case"$lte":-1!==n&&0!==n||(r.push(e.id),r.push(...e.siblings));break;case"$gt":1===n&&(r.push(e.id),r.push(...e.siblings));break;case"$gte":1!==n&&0!==n||(r.push(e.id),r.push(...e.siblings));break;case"$between":n>=0&&o<=0&&(r.push(e.id),r.push(...e.siblings))}else r.push(e.id),r.push(...e.siblings);if(e.right)if(t)switch(t.op){case"$lt":case"$lte":-1===n&&r.push(...this.collateRequest(this.nodes[e.right],t));break;case"$gt":case"$gte":r.push(...this.collateRequest(this.nodes[e.right],t));break;case"$between":-1===o&&r.push(...this.collateRequest(this.nodes[e.right],t))}else r.push(...this.collateRequest(this.nodes[e.right],t));return r}collateIds(e){let t=[];return e?(e.left&&(t=this.collateIds(this.nodes[e.left])),t.push(e.id),t.push(...e.siblings),e.right&&t.push(...this.collateIds(this.nodes[e.right])),t):[]}locate(e,t){for(;null!==e;)switch(this.comparator(t,e.value)){case 0:return e;case 1:if(!e.right)return null;e=this.nodes[e.right];break;case-1:if(!e.left)return null;e=this.nodes[e.left]}return null}validateIndex(){if(!this.apex)return 0===Object.keys(this.nodes).length;if(null!==this.nodes[this.apex].parent)return!1;let e=this.collateIds(this.nodes[this.apex]),t=Object.keys(this.nodes).length;if(e.length!==t)return!1;if(1===e.length)return null===this.nodes[e[0]].parent&&null===this.nodes[e[0]].left&&null===this.nodes[e[0]].right;for(let i=0;i<e.length-1;i++)if(1===this.comparator(this.nodes[e[i]].value,this.nodes[e[i+1]].value))return!1;return this.validateNode(this.nodes[this.apex])}validateNode(e){if(-1!==[e.parent,e.left,e.right].indexOf(e.id))return!1;let t=e.left?this.nodes[e.left].height:-1,hr=e.right?this.nodes[e.right].height:-1,r=1+Math.max(t,hr);if(e.height!==r)return!1;if(e.balance!==hr-t)return!1;if(e.siblings.length>0)for(let t of e.siblings)if(this.nodes[t].parent!==e.id)return!1;if(e.left){if(this.nodes[e.left].parent!==e.id)return!1;if(!this.validateNode(this.nodes[e.left]))return!1}if(e.right){if(this.nodes[e.right].parent!==e.id)return!1;if(!this.validateNode(this.nodes[e.right]))return!1}return!0}}r.d(t,"a",(function(){return o}));let o={avl:(e,t)=>new n(e,t)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(){this._events={},this._asyncListeners=!1}on(e,t){let r;return Array.isArray(e)?(e.forEach((e=>{this.on(e,t)})),t):(r=this._events[e],r||(r=this._events[e]=[]),r.push(t),t)}emit(e,...data){e&&this._events[e]&&this._events[e].forEach((e=>{this._asyncListeners?setTimeout((()=>{e(...data)}),1):e(...data)}))}addListener(e,t){return this.on(e,t)}removeListener(e,t){if(Array.isArray(e)&&e.forEach((e=>{this.removeListener(e,t)})),this._events[e]){const r=this._events[e];r.splice(r.indexOf(t),1)}}}},function(e,t,r){"use strict";(function(e){r.d(t,"a",(function(){return f}));var n=r(5),o=r(3),l=r(1),h=r(0),d=r(4),c=r(2);function _(){if(void 0!==e&&(e.android||e.NSObject))return"NATIVESCRIPT";if(void 0!==e&&"[object process]"==={}.toString.call(e.process))return e.window,"NODEJS";if(void 0!==document)return-1===document.URL.indexOf("http://")&&-1===document.URL.indexOf("https://")?"CORDOVA":"BROWSER";if(void 0!==window&&"[object Window]"==={}.toString.call(window))return"BROWSER";throw SyntaxError("Unknown environment...")}class f extends n.a{constructor(e="loki.db",t={}){if(super(),this.databaseVersion=1.5,this.engineVersion=1.5,this._persistenceMethod=null,this._persistenceAdapter=null,this._throttledSaves=!0,this._throttledSaveRunning=null,this._throttledSavePending=null,this._autosave=!1,this._autosaveInterval=5e3,this._autosaveRunning=!1,this._autosaveHandler=Promise.resolve(),this.filename=e,this._collections=[],({serializationMethod:this._serializationMethod="normal",destructureDelimiter:this._destructureDelimiter="$<\n",env:this._env=_()}=t),this._events={init:[],loaded:[],flushChanges:[],close:[],changes:[],warning:[]},t.comparatorMap)for(let e in t.comparatorMap)h.a[e]=t.comparatorMap[e];if(t.rangedIndexFactoryMap)for(let e in t.rangedIndexFactoryMap)d.a[e]=t.rangedIndexFactoryMap[e];if(t.lokiOperatorPackageMap)for(let e in t.lokiOperatorPackageMap)c.a[e]=t.lokiOperatorPackageMap[e];this.on("init",this.clearChanges)}initializePersistence(e={}){let t=this._autosaveDisable();({autosave:this._autosave=!1,autosaveInterval:this._autosaveInterval=5e3,persistenceMethod:this._persistenceMethod,throttledSaves:this._throttledSaves=!0}=e);const r={NODEJS:["fs-storage"],BROWSER:["local-storage","indexed-storage"],CORDOVA:["local-storage","indexed-storage"],MEMORY:["memory-storage"]},n={"fs-storage":l.a.FSStorage,"local-storage":l.a.LocalStorage,"indexed-storage":l.a.IndexedStorage,"memory-storage":l.a.MemoryStorage};if(void 0!==this._persistenceMethod){if("function"!=typeof n[this._persistenceMethod])throw Error("Unknown persistence method.");this._persistenceAdapter=new n[this._persistenceMethod]}if(void 0!==e.adapter&&(this._persistenceMethod="adapter",this._persistenceAdapter=e.adapter),null===this._persistenceAdapter){let e=r[this._env];if(e)for(let i=0;i<e.length;i++)if(n[e[i]]){this._persistenceMethod=e[i],this._persistenceAdapter=new n[e[i]];break}}return e.autoload&&(t=t.then((()=>this._loadDatabase(e.inflate,!0)))),t.then((()=>{this._autosaveEnable()}))}copy(e={}){const t=new f(this.filename,{env:this._env});if(t.loadJSONObject(this,{retainDirtyFlags:!0}),e.removeNonSerializable){t._persistenceAdapter=null;for(let e=0;e<t._collections.length;e++)t._collections[e]._constraints=null,t._collections[e]._ttl=null}return t}addCollection(e,t={}){for(let i=0;i<this._collections.length;i++)if(this._collections[i].name===e)return this._collections[i];const r=new o.a(e,t);return this._collections.push(r),r}loadCollection(e){if(!e.name)throw new Error("Collection must have a name property to be loaded");this._collections.push(e)}getCollection(e){for(let i=0;i<this._collections.length;i++)if(this._collections[i].name===e)return this._collections[i];return this.emit("warning","collection "+e+" not found"),null}renameCollection(e,t){const r=this.getCollection(e);return r&&(r.name=t),r}listCollections(){const e=[];for(let i=0;i<this._collections.length;i++)e.push({name:this._collections[i].name,count:this._collections[i].count()});return e}removeCollection(e){for(let i=0;i<this._collections.length;i++)if(this._collections[i].name===e){const t=new o.a(e,{}),r=this._collections[i];for(const e in r)void 0!==r[e]&&void 0!==t[e]&&(r[e]=t[e]);return void this._collections.splice(i,1)}}serialize(e={}){switch(void 0===e.serializationMethod&&(e.serializationMethod=this._serializationMethod),e.serializationMethod){default:return JSON.stringify(this);case"pretty":return JSON.stringify(this,null,2);case"destructured":return this.serializeDestructured()}}toJSON(){return{_env:this._env,_serializationMethod:this._serializationMethod,_autosave:this._autosave,_autosaveInterval:this._autosaveInterval,_collections:this._collections,databaseVersion:this.databaseVersion,engineVersion:this.engineVersion,filename:this.filename,_persistenceAdapter:this._persistenceAdapter,_persistenceMethod:this._persistenceMethod,_throttledSaves:this._throttledSaves}}serializeDestructured(e={}){if(void 0===e.partitioned&&(e.partitioned=!1),void 0===e.delimited&&(e.delimited=!0),void 0===e.delimiter&&(e.delimiter=this._destructureDelimiter),!0===e.partitioned&&void 0!==e.partition&&e.partition>=0)return this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:e.partition});let t=new f(this.filename);t.loadJSONObject(this);for(let e=0;e<t._collections.length;e++)t._collections[e]._data=[];if(!0===e.partitioned&&-1===e.partition)return t.serialize({serializationMethod:"normal"});const r=[];r.push(t.serialize({serializationMethod:"normal"})),t=null;for(let t=0;t<this._collections.length;t++){let n=this.serializeCollection({delimited:e.delimited,delimiter:e.delimiter,collectionIndex:t});if(!1===e.partitioned&&!1===e.delimited){if(!Array.isArray(n))throw new Error("a nondelimited, non partitioned collection serialization did not return an expected array");for(let e=0;e<n.length;e++)r.push(n[e]),n[e]=null;r.push("")}else r.push(n)}return e.partitioned?(e.delimited,r):e.delimited?(r.push(""),r.join(e.delimiter)):(r.push(""),r)}serializeCollection(e={}){if(void 0===e.delimited&&(e.delimited=!0),void 0===e.collectionIndex)throw new Error("serializeCollection called without 'collectionIndex' option");const t=this._collections[e.collectionIndex].count();let r=[];for(let n=0;n<t;n++)r.push(JSON.stringify(this._collections[e.collectionIndex]._data[n]));return e.delimited?(r.push(""),r.join(e.delimiter)):r}deserializeDestructured(e,t={}){if(void 0===t.partitioned&&(t.partitioned=!1),void 0===t.delimited&&(t.delimited=!0),void 0===t.delimiter&&(t.delimiter=this._destructureDelimiter),t.partitioned){if(void 0!==t.partition)return-1===t.partition?JSON.parse(e[0]):this.deserializeCollection(e[t.partition+1],t);const r=JSON.parse(e[0]),n=r._collections.length;for(let o=0;o<n;o++)r._collections[o]._data=this.deserializeCollection(e[o+1],t);return r}let r=[];if(t.delimited){if(r=e.split(t.delimiter),e=null,0===r.length)return null}else r=e;const n=JSON.parse(r[0]),o=n._collections.length;r[0]=null;let l=0,h=1,d=!1;for(;!d;)""===r[h]?++l>o&&(d=!0):n._collections[l]._data.push(JSON.parse(r[h])),r[h++]=null;return n}deserializeCollection(e,t={}){void 0===t.partitioned&&(t.partitioned=!1),void 0===t.delimited&&(t.delimited=!0),void 0===t.delimiter&&(t.delimiter=this._destructureDelimiter);let r=[];t.delimited?(r=e.split(t.delimiter),r.pop()):r=e;for(let e=0;e<r.length;e++)r[e]=JSON.parse(r[e]);return r}loadJSON(e,t){let r;r=0===e.length?{}:"destructured"===this._serializationMethod?this.deserializeDestructured(e):JSON.parse(e),this.loadJSONObject(r,t)}loadJSONObject(e,t={}){const r=e._collections?e._collections.length:0;this.filename=e.filename,this._collections=[];for(let i=0;i<r;++i)this._collections.push(o.a.fromJSONObject(e._collections[i],t))}close(){return this._autosave?this._autosaveDisable().then((()=>this._autosaveDirty()?this.saveDatabase():Promise.resolve())):Promise.resolve().then((()=>{this.emit("close")}))}generateChangesNotification(e){let t=[];const r=e||this._collections.map((e=>e.name));return this._collections.forEach((e=>{-1!==r.indexOf(e.name)&&(t=t.concat(e.getChanges()))})),t}serializeChanges(e){return JSON.stringify(this.generateChangesNotification(e))}clearChanges(){this._collections.forEach((e=>{e.flushChanges&&e.flushChanges()}))}throttledSaveDrain(e={}){const t=(new Date).getTime();return this._throttledSaves?(void 0===e.recursiveWait&&(e.recursiveWait=!0),void 0===e.recursiveWaitLimit&&(e.recursiveWaitLimit=!1),void 0===e.recursiveWaitLimitDuration&&(e.recursiveWaitLimitDuration=2e3),void 0===e.started&&(e.started=new Date),this._throttledSaves&&null!==this._throttledSaveRunning?e.recursiveWait?Promise.resolve(Promise.all([this._throttledSaveRunning,this._throttledSavePending])).then((()=>null!==this._throttledSaveRunning||null!==this._throttledSavePending?e.recursiveWaitLimit&&t-e.started.getTime()>e.recursiveWaitLimitDuration?Promise.reject({}):this.throttledSaveDrain(e):Promise.resolve())):Promise.resolve(this._throttledSaveRunning):Promise.resolve()):Promise.resolve()}_loadDatabase(e={},t=!1){return null===this._persistenceAdapter?Promise.reject(new Error("persistenceAdapter not configured")):Promise.resolve(this._persistenceAdapter.loadDatabase(this.filename)).then((t=>{if("string"==typeof t)this.loadJSON(t,e),this.emit("load",this);else{if("object"!=typeof t||null===t||t instanceof Error)throw t;this.loadJSONObject(t,e),this.emit("load",this)}})).catch((e=>{if(e instanceof Error)throw e;if(null!=e)throw new TypeError("The persistence adapter did not load a serialized DB string or object.");if(!t)throw new Error("Database not found.")}))}loadDatabase(e={}){return this._throttledSaves?this.throttledSaveDrain(e).then((()=>(this._throttledSaveRunning=this._loadDatabase(e).then((()=>{this._throttledSaveRunning=null})),this._throttledSaveRunning)),(()=>{throw new Error("Unable to pause save throttling long enough to read database")})):this._loadDatabase(e)}_saveDatabase(){return null===this._persistenceAdapter?Promise.reject(new Error("persistenceAdapter not configured")):"reference"===this._persistenceAdapter.mode&&"function"==typeof this._persistenceAdapter.exportDatabase?Promise.resolve(this._persistenceAdapter.exportDatabase(this.filename,this.copy({removeNonSerializable:!0}))).then((()=>{this._autosaveClearFlags(),this.emit("save")})):(this._autosaveClearFlags(),Promise.resolve(this._persistenceAdapter.saveDatabase(this.filename,this.serialize())).then((()=>{this.emit("save")})))}saveDatabase(){return this._throttledSaves?(null!==this._throttledSaveRunning&&null===this._throttledSavePending&&(this._throttledSavePending=Promise.resolve(this._throttledSaveRunning).then((()=>(this._throttledSaveRunning=null,this._throttledSavePending=null,this.saveDatabase())))),null!==this._throttledSavePending?this._throttledSavePending:(this._throttledSaveRunning=this._saveDatabase().then((()=>{this._throttledSaveRunning=null})),this._throttledSaveRunning)):this._saveDatabase()}deleteDatabase(){return null===this._persistenceAdapter?Promise.reject(new Error("persistenceAdapter not configured")):Promise.resolve(this._persistenceAdapter.deleteDatabase(this.filename))}_autosaveDirty(){for(let e=0;e<this._collections.length;e++)if(this._collections[e]._dirty)return!0;return!1}_autosaveClearFlags(){for(let e=0;e<this._collections.length;e++)this._collections[e]._dirty=!1}_autosaveEnable(){if(!this._autosave||this._autosaveRunning)return;this._autosaveRunning=!0;const e=setInterval((()=>{this._autosaveRunning?this._autosaveDirty()&&(this._autosaveHandler=this._autosaveHandler.then((()=>this.saveDatabase()))):clearInterval(e)}),this._autosaveInterval)}_autosaveDisable(){return this._autosaveRunning=!1,this._autosaveHandler}}}).call(this,r(7))},function(e,t){var g;g=function(){return this}();try{g=g||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(g=window)}e.exports=g},function(e,t,r){"use strict";r.r(t);var n=r(6);r.d(t,"Loki",(function(){return n.a}));var o=r(3);r.d(t,"Collection",(function(){return o.a})),n.a.Collection=o.a,t.default=n.a}])},e.exports=n()}}]);